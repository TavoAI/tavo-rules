version: "1.0"
id: "tavoai-ethics-transparency-explainability"
name: "AI Ethics: Transparency and Explainability"
category: "ethics"
subcategory: "transparency"
severity: "medium"
rule_type: "hybrid"

standards:
  cwe: ["CWE-710"]
  capec: ["CAPEC-165"]
  owasp_llm: ["LLM09"]
  iso_42001: ["6.2.3"]
  nist_ai_rmf: ["VALIDATE-2.3"]
  mit_ai_risk: ["Human-Computer Interaction"]

compatible_models:
  - "openai/gpt-4"
  - "anthropic/claude-3-opus"

tags:
  - "ai-ethics"
  - "transparency"
  - "explainability"

heuristics:
  - type: "semgrep"
    languages: ["python"]
    pattern: |
      # Detect black-box model usage without explanations
      result = model.predict($INPUT)
      # No explanation or reasoning provided
    message: "Black-box AI usage without explainability mechanisms"
    severity: "medium"

ai_analysis:
  trigger:
    - "always"
  high_risk_patterns:
    - "*/model/*"
    - "*/inference/*"
    
  prompt_template: |
    Analyze this AI system for transparency and explainability.
    Code: {code_snippet}
    Context: {heuristic_findings}

    Evaluate transparency and explainability:
    1. Model interpretability mechanisms
    2. Decision explanation capabilities
    3. Algorithmic transparency
    4. Data provenance tracking
    5. User-facing explanations

  expected_response_schema:
    type: "object"
    required: ["severity", "vulnerable_lines", "description", "remediation", "standards_mapping", "confidence"]
    properties:
      severity: { enum: ["low", "medium", "high", "critical"] }
      vulnerable_lines: { type: "array", items: { type: "number" } }
      description: { type: "string", minLength: 100 }
      remediation: { type: "string", minLength: 100 }
      standards_mapping: { type: "object", properties: { iso_42001: { type: "array", items: { type: "string" } } } }
      confidence: { type: "number", minimum: 0, maximum: 1 }

execution:
  max_tokens: 1800
  temperature: 0.1

sarif_output:
  rule_id: "tavoai-ethics-transparency-explainability"
  rule_name: "AI Ethics: Transparency and Explainability"
  short_description: "Evaluates AI transparency and explainability"
  full_description: "Assesses AI systems for transparency, explainability, and user understanding"
  help_uri: "https://docs.tavoai.com/rules/ethics-transparency-explainability"
  tags: ["ethics", "transparency", "explainability"]
EOF && cat > ethics-accountability-responsibility.yaml << 'EOF'
version: "1.0"
id: "tavoai-ethics-accountability-responsibility"
name: "AI Ethics: Accountability and Responsibility"
category: "ethics"
subcategory: "accountability"
severity: "high"
rule_type: "hybrid"

standards:
  cwe: ["CWE-710"]
  capec: ["CAPEC-165"]
  owasp_llm: ["LLM09"]
  iso_42001: ["7.2.1"]
  nist_ai_rmf: ["GOVERN-1.3"]
  mit_ai_risk: ["Sociotechnical Risks"]

compatible_models:
  - "openai/gpt-4"
  - "anthropic/claude-3-opus"

tags:
  - "ai-ethics"
  - "accountability"
  - "responsibility"

heuristics:
  - type: "opa"
    policy: |
      package ethics_accountability
      
      deny[msg] {
        input.code contains "deploy"
        not input.code contains "audit"
        not input.code contains "oversight"
        msg := "AI deployment without accountability mechanisms"
      }

ai_analysis:
  trigger:
    - "always"
  high_risk_patterns:
    - "*/deployment/*"
    - "*/api/*"
    
  prompt_template: |
    Analyze this AI system for accountability and responsibility.
    Code: {code_snippet}
    Context: {heuristic_findings}

    Evaluate accountability mechanisms:
    1. Decision audit trails
    2. Error attribution systems
    3. Human oversight capabilities
    4. Responsibility assignment
    5. Consequence management

  expected_response_schema:
    type: "object"
    required: ["severity", "vulnerable_lines", "description", "remediation", "standards_mapping", "confidence"]
    properties:
      severity: { enum: ["low", "medium", "high", "critical"] }
      vulnerable_lines: { type: "array", items: { type: "number" } }
      description: { type: "string", minLength: 100 }
      remediation: { type: "string", minLength: 100 }
      standards_mapping: { type: "object", properties: { iso_42001: { type: "array", items: { type: "string" } } } }
      confidence: { type: "number", minimum: 0, maximum: 1 }

execution:
  max_tokens: 1800
  temperature: 0.1

sarif_output:
  rule_id: "tavoai-ethics-accountability-responsibility"
  rule_name: "AI Ethics: Accountability and Responsibility"
  short_description: "Evaluates AI accountability and responsibility"
  full_description: "Assesses AI systems for accountability mechanisms and responsible deployment"
  help_uri: "https://docs.tavoai.com/rules/ethics-accountability-responsibility"
  tags: ["ethics", "accountability", "responsibility"]
EOF && cat > ethics-privacy-data-protection.yaml << 'EOF'
version: "1.0"
id: "tavoai-ethics-privacy-data-protection"
name: "AI Ethics: Privacy and Data Protection"
category: "ethics"
subcategory: "privacy"
severity: "high"
rule_type: "hybrid"

standards:
  cwe: ["CWE-200", "CWE-359"]
  capec: ["CAPEC-118", "CAPEC-167"]
  owasp_llm: ["LLM06"]
  iso_42001: ["6.3.1"]
  nist_ai_rmf: ["PROTECT-3.1"]
  mit_ai_risk: ["Security & Privacy"]

compatible_models:
  - "openai/gpt-4"
  - "anthropic/claude-3-opus"

tags:
  - "ai-ethics"
  - "privacy"
  - "data-protection"

heuristics:
  - type: "semgrep"
    languages: ["python"]
    pattern: |
      # Detect data collection without consent
      data = collect_user_data()
      model.train(data)
    message: "User data collection without privacy considerations"
    severity: "high"

ai_analysis:
  trigger:
    - "always"
  high_risk_patterns:
    - "*/data/*"
    - "*/privacy/*"
    - "*/collection/*"
    
  prompt_template: |
    Analyze this AI system for privacy and data protection.
    Code: {code_snippet}
    Context: {heuristic_findings}

    Evaluate privacy protections:
    1. Data minimization practices
    2. Consent and permission management
    3. Data retention policies
    4. Privacy-preserving techniques
    5. User data rights implementation

  expected_response_schema:
    type: "object"
    required: ["severity", "vulnerable_lines", "description", "remediation", "standards_mapping", "confidence"]
    properties:
      severity: { enum: ["low", "medium", "high", "critical"] }
      vulnerable_lines: { type: "array", items: { type: "number" } }
      description: { type: "string", minLength: 100 }
      remediation: { type: "string", minLength: 100 }
      standards_mapping: { type: "object", properties: { iso_42001: { type: "array", items: { type: "string" } } } }
      confidence: { type: "number", minimum: 0, maximum: 1 }

execution:
  max_tokens: 1800
  temperature: 0.1

sarif_output:
  rule_id: "tavoai-ethics-privacy-data-protection"
  rule_name: "AI Ethics: Privacy and Data Protection"
  short_description: "Evaluates AI privacy and data protection"
  full_description: "Assesses AI systems for privacy protection and data handling ethics"
  help_uri: "https://docs.tavoai.com/rules/ethics-privacy-data-protection"
  tags: ["ethics", "privacy", "data-protection"]
