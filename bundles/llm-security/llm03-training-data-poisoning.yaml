rules:
  - id: llm03-training-data-poisoning
    message: "Training data poisoning risk: Untrusted data sources used for model training"
    languages: [python, javascript, typescript]
    pattern: |
      $MODEL.train($DATA.from_url(...))
    severity: HIGH
    metadata:
      cwe: "CWE-20"
      owasp-llm: "LLM03"
      category: "training-data-poisoning"
      description: "Detects use of untrusted or external data sources for model training"

  - id: llm03-data-validation-missing
    message: "Missing data validation: Training data not validated before use"
    languages: [python, javascript, typescript]
    pattern: |
      $MODEL.train($DATA)
    severity: MEDIUM
    metadata:
      cwe: "CWE-20"
      owasp-llm: "LLM03"
      category: "training-data-poisoning"
      description: "Detects training data loading without validation steps"

  - id: llm03-malicious-dataset-handling
    message: "Potential malicious dataset handling: Direct processing of user-provided datasets"
    languages: [python, javascript, typescript]
    pattern: |
      $DATASET = request.files['dataset']
      $MODEL.train($DATASET)
    severity: HIGH
    metadata:
      cwe: "CWE-434"
      owasp-llm: "LLM03"
      category: "training-data-poisoning"
      description: "Detects direct processing of user-uploaded datasets for training"
