rules:
  - id: llm07-insecure-plugin-design
    message: "Insecure plugin design: Plugins execute code with LLM input"
    languages: [python, javascript, typescript]
    pattern: |
      $PLUGIN.execute($LLM_RESPONSE.content)
    severity: HIGH
    metadata:
      cwe: "CWE-94"
      owasp-llm: "LLM07"
      category: "insecure-plugin-design"
      description: "Detects plugins that execute code using LLM responses"

  - id: llm07-unsafe-plugin-loading
    message: "Unsafe plugin loading: Dynamic loading of untrusted plugins"
    languages: [python, javascript, typescript]
    pattern: |
      importlib.import_module($USER_PLUGIN_NAME)
    severity: HIGH
    metadata:
      cwe: "CWE-470"
      owasp-llm: "LLM07"
      category: "insecure-plugin-design"
      description: "Detects dynamic loading of potentially unsafe plugins"

  - id: llm07-plugin-sandbox-escape
    message: "Plugin sandbox escape: Plugins bypassing security restrictions"
    languages: [python, javascript, typescript]
    pattern: |
      $PLUGIN.bypass_sandbox()
    severity: CRITICAL
    metadata:
      cwe: "CWE-693"
      owasp-llm: "LLM07"
      category: "insecure-plugin-design"
      description: "Detects plugins attempting to escape security sandboxes"
