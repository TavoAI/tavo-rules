rules:
  - id: llm05-supply-chain-untrusted-package
    message: "Supply chain risk: Untrusted or unofficial LLM packages used"
    languages: [python, javascript, typescript]
    pattern: |
      pip install git+https://github.com/untrusted/llm-package
    severity: HIGH
    metadata:
      cwe: "CWE-1357"
      owasp-llm: "LLM05"
      category: "supply-chain-vulnerabilities"
      description: "Detects installation of untrusted LLM packages from unofficial sources"

  - id: llm05-outdated-dependencies
    message: "Outdated dependencies: Using deprecated or vulnerable LLM library versions"
    languages: [python, javascript, typescript]
    pattern: |
      import openai
      openai.__version__ < "1.0.0"
    severity: MEDIUM
    metadata:
      cwe: "CWE-1104"
      owasp-llm: "LLM05"
      category: "supply-chain-vulnerabilities"
      description: "Detects use of outdated or vulnerable LLM library versions"

  - id: llm05-malicious-model-loading
    message: "Malicious model loading: Models loaded from untrusted sources"
    languages: [python, javascript, typescript]
    pattern: |
      $MODEL = load_model_from_url("http://untrusted.com/model")
    severity: HIGH
    metadata:
      cwe: "CWE-1357"
      owasp-llm: "LLM05"
      category: "supply-chain-vulnerabilities"
      description: "Detects loading of models from potentially malicious sources"
